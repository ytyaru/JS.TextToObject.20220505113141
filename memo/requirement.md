# è¦ä»¶å®šç¾©

## å½¢å¼

ã€€æœ€çµ‚æˆæœç‰©ã®å½¢å¼ã¯JavaScriptãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹ã€‚GitHubã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã€‚æœ€é©åŒ–ã«ã„ãŸã‚‹ãƒ•ã‚§ãƒ¼ã‚ºã¯ä»¥ä¸‹ã€‚ã“ã®ã†ã¡ã€ŒGlobalé–¢æ•°ã€ã‹ã€ŒES6 Classã€ã®å°‘ãªãã¨ã‚‚ã„ãšã‚Œã‹ã²ã¨ã¤ã‚’ä½œæˆã™ã‚‹ã€‚ãã‚Œä»¥å¤–ã®å½¢å¼ã«é–¢ã—ã¦ã¯ã€ä½™åŠ›ãŒã‚ã‚Œã°ã‚„ã‚‹ãŒã€åŸºæœ¬çš„ã«ã¯å¯¾è±¡å¤–ã€‚

* Globalé–¢æ•°
* ES6 Class
* ES6 Module
* Minify
* CDN
* TypeScript
    * ãƒˆãƒ©ãƒ³ã‚¹ãƒ‘ã‚¤ãƒ«
    * WebPack
* AssemblyScript
    * ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ï¼ˆwasmï¼‰
    * CDN

## è¦ä»¶å®šç¾©

ã€€[background.md][]ã«ã‚ã‚‹ã‚ˆã†ã«ã€ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚„é…åˆ—ã‚’è¿”ã—ã¦ã»ã—ã„ã€‚ã•ã¾ã–ã¾ãªå½¢å¼ãŒã‚ã‚‹ãŸã‚ã€ãã®å½¢å¼ã‹ã‚‰ã©ã®ã‚ˆã†ãªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨å‡ºåŠ›çµæœãŒã‚ã‚Œã°ã‚ˆã„ã‹è€ƒãˆã¦ã¿ã‚‹ã€‚

[background.md]:background.md

ã€€å¤§é›‘æŠŠã«ã¿ã‚‹ã¨ãƒ†ã‚­ã‚¹ãƒˆã®å½¢å¼ã¯ä»¥ä¸‹ã§ã‚ã‚‹ã€‚

* å˜ä¸€è¡Œã§ã²ã¤ã¤ã®è¦ç´ ã‚’ã‚ã‚‰ã‚ã™ï¼ˆåŒä¸€è¡Œã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ä»˜ä¸å¯ï¼‰
* è¤‡æ•°è¡Œã§ã²ã¨ã¤ã®è¦ç´ ã‚’ã‚ã‚‰ã‚ã™ï¼ˆ2ã¤ä»¥ä¸Šã®æ”¹è¡Œã§æ¬¡ã®æ–°ã—ã„åˆ¥ã®è¦ç´ ã¸ã€‚è¦ç´ ã¯è¡Œä½ç½®ã§å€¤ã‚’å–ã‚Šå‡ºã—ã€schema.orgã‚­ãƒ¼ã¨ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ï¼‰
* ãƒ„ãƒªãƒ¼æ§‹é€ ï¼ˆãƒã‚¹ãƒˆã§åŒ…å«é–¢ä¿‚ã‚’ã‚ã‚‰ã‚ã™ã€‚åŒä¸€è¡Œã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ä»˜ä¸å¯ï¼‰

ã€€ãã‚Œã‚‰ã‚’å‹ã¨ã—ã¦åä»˜ã‘ã¦ã¿ã‚‹ã€‚

* SingleLineElementï¼ˆå˜ä¸€è¡Œè¦ç´ ï¼‰
* MultiLineElementï¼ˆè¤‡æ•°è¡Œè¦ç´ ï¼‰
* TreeElementï¼ˆæœ¨æ§‹é€ è¦ç´ ï¼‰

ã€€ãŸã¨ãˆã°BreadcrumbListã€HowToToolã€HowToSupplyã¯å˜ä¸€è¡Œè¦ç´ ã‚’è¤‡æ•°ã‚‚ã£ãŸå½¢å¼ã§ã‚ã‚‹ã€‚

ã€€ãŸã¨ãˆã°FAQã€Quizã€Articleã€Datasetã€SoftwareApplicationã¯è¤‡æ•°è¡Œè¦ç´ ã‚’è¤‡æ•°ã‚‚ã£ãŸå½¢å¼ã§ã‚ã‚‹ã€‚

ã€€ãŸã¨ãˆã°HowToStepã¯æœ¨æ§‹é€ è¦ç´ ã‚’ã²ã¨ã¤ã ã‘ã‚‚ã£ãŸå½¢å¼ã§ã‚ã‚‹ã€‚

ã€€ãŸã¨ãˆã°HowToã¯è¤‡æ•°è¡Œè¦ç´ ã¨æœ¨æ§‹é€ è¦ç´ ã‚’ãã‚Œãã‚Œã²ã¨ã¤ã ã‘ã‚‚ã£ãŸå½¢å¼ã§ã‚ã‚‹ã€‚

### SingleLineElementï¼ˆå˜ä¸€è¡Œè¦ç´ ï¼‰

```
åå‰ï¼ˆå€¤ã€‚å¿…é ˆï¼‰    ã‚ªãƒ—ã‚·ãƒ§ãƒ³1ï¼ˆä»»æ„ï¼‰  ã‚ªãƒ—ã‚·ãƒ§ãƒ³2ï¼ˆä»»æ„ï¼‰  ...
```

ã€€ã²ã¨ã¤ã®è¦ç´ ã‚’ä¸€è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆã§è¡¨ç¾ã™ã‚‹ã€‚ä¸€è¡Œã®ãƒ†ã‚­ã‚¹ãƒˆã¯ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ–‡å­—åˆ—ï¼ˆåŒºåˆ‡ã‚Šæ–‡å­—åˆ—ï¼‰ã§åˆ†å‰²ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚åˆ†å‰²ã™ã‚‹ã¨ã€ã“ã®ã¨ãæœ€ã‚‚å·¦ã«å‡ºç¾ã™ã‚‹

```javascript
const element = TextElement.Single(txt)
element.name;         // åå‰ï¼ˆå€¤ã€‚å¿…é ˆï¼‰
element.options[0];   // ã‚ªãƒ—ã‚·ãƒ§ãƒ³1ï¼ˆä»»æ„ï¼‰
element.options[1];   // ã‚ªãƒ—ã‚·ãƒ§ãƒ³2ï¼ˆä»»æ„ï¼‰
element.options[...]; // ...
```

ã€€æœ€åˆã®å€¤ã‚’å¼•ãå‡ºã™ã‚­ãƒ¼ã¯ã©ã†ã™ã‚‹ã‹ã€‚`name`,`value`,`title`ãªã©ã®å€™è£œãŒæ€ã„ã¤ããŒã€ã©ã‚Œã«ã™ã‚‹ï¼Ÿã€€ãã‚Œã¨ã‚‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚‚ã™ã¹ã¦å«ã‚ã¦`values[0]`ã«ã™ã‚‹ï¼Ÿ

```javascript
const element = TextElement.Single(txt)
element.name;            // åå‰ï¼ˆå€¤ã€‚å¿…é ˆï¼‰
element.value;           // åå‰ï¼ˆå€¤ã€‚å¿…é ˆï¼‰
element.title;           // åå‰ï¼ˆå€¤ã€‚å¿…é ˆï¼‰
element.values[0];       // åå‰ï¼ˆå€¤ã€‚å¿…é ˆï¼‰
element.values.slice(1); // ã‚ªãƒ—ã‚·ãƒ§ãƒ³é…åˆ—
```

ã€€åå‰ã¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯åˆ†ã‘ãŸã»ã†ãŒã„ã„ã€‚ç†ç”±ã¯äºŒã¤ã‚ã‚‹ã€‚

ã€€ã²ã¨ã¤ç›®ã¯åˆ¶ç´„ã®é•ã„ãŒã‚ã‚‹ã‹ã‚‰ã€‚åå‰ã¯å¿…é ˆã ãŒã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ä»»æ„ã ã‹ã‚‰ã€‚ã‚‚ã—ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å–ã‚Šå‡ºãã†ã¨ã—ã¦`element.values.slice(1)`ã¨ã‚„ã£ã¦ã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒã²ã¨ã¤ã‚‚ãªã‹ã£ãŸã‚‰ï¼Ÿã€€ç©ºé…åˆ—`[]`ãŒè¿”ã£ã¦ãã‚‹ã€‚ã§ã‚‚ã‚‚ã—ã‹ã—ãŸã‚‰`undefined`ã‚„`null`ãŒè¿”ã£ã¦ãã‚‹ã‹ã‚‚ã—ã‚Œãªã„ã¨æ€ã£ã¦ã—ã¾ã†ã€‚

ã€€ãµãŸã¤ç›®ã¯ã‚¢ã‚¯ã‚»ã‚¹ã®ã—ã‚„ã™ã•ã€‚`value[0]`ã‚ˆã‚Šã‚‚`name`ã®ã»ã†ãŒèª­ã¿ã‚„ã™ã„ã€‚`value[0]`ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹å€¤`0`ã¯ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ã«ãªã£ã¦ã—ã¾ã†ã€‚ä½•ã‚’å…¥ã‚ŒãŸã‚‰ä½•ãŒå–å¾—ã§ãã‚‹ã®ã‹ã‚ã‹ã‚Šã«ãã„ã€‚

ã€€åå‰ã®ã‚­ãƒ¼åã¯`name`ãŒã‚ˆã„ã€‚`value`ã ã¨æ±ç”¨çš„ã™ãã‚‹ã€‚å…ˆè¿°ã®ã‚ˆã†ã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚‚å«ã‚ã¦`values[]`ã¨è¡¨ç¾ã§ãã¦ã—ã¾ã†ã€‚`title`ã‚„`caption`ã¯è¡¨é¡Œã ãŒã€ãã‚Œãªã‚‰åå‰`name`ã®ã»ã†ãŒã‚·ãƒ³ãƒ—ãƒ«ã ã—çŸ­ãæ›¸ã‘ã‚‹ã€‚æ±ç”¨æ€§ã‚‚é«˜ã„ã€‚`key`ã«ã™ã‚‹ã®ã¯ãµã•ã‚ã—ããªã„ã€‚ã‚­ãƒ¼ã¯ä½•è¡Œç›®ã«ã‚ã‚‹ã‹ã®ä½ç½®ã§ã‚ã£ãŸã‚Šã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆéšå±¤æ•°ã§ã‚ã£ãŸã‚Šã™ã‚‹ã€‚ã‚ˆã£ã¦å¿…é ˆå€¤ã‚’å‚ç…§ã™ã‚‹ã‚­ãƒ¼åã¨ã—ã¦ã¯`name`ãŒå¦¥å½“ã€‚

ã€€å–å¾—ã•ã‚Œã‚‹å€¤ã¯ã™ã¹ã¦æ–‡å­—åˆ—ã§ã‚ã‚‹ã€‚åå‰ã‚‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚‚ã™ã¹ã¦æ–‡å­—åˆ—ã ã€‚

ã€€ã‚‚ã—ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚­ãƒ¼ã«ç´ä»˜ã‘ãŸã‘ã‚Œã°ã€ãƒ†ã‚­ã‚¹ãƒˆå€¤ã¨ã—ã¦`key:value`ã®ã‚ˆã†ã«ã™ã‚‹ãªã©å·¥å¤«ã™ã‚‹ã€‚ãŸã ã—æœ¬ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ãã®ãŸã‚ã®å‡¦ç†ã‚’ä¸€åˆ‡ã—ãªã„ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«è‡ªåŠ›ã§è¡Œã†ã“ã¨ã€‚

```javascript
const element = TextElement.Single(`åå‰    key1:å€¤1    key2:å€¤2`)
element.name;         // åå‰
element.options[0];   // key1:å€¤1
element.options[1];   // key2:å€¤2
const obj = {}
for (const option of element.options) {
    const [key, value] = option.split(':')
    obj[key] = value
}
```

ã€€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–ãŒå¯¾è±¡å¤–ã§ã‚ã‚‹ç†ç”±ã¯äºŒã¤ã‚ã‚‹ã€‚

ã€€ã²ã¨ã¤ç›®ã¯æƒ³å®šå¤–ã ã‹ã‚‰ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ã‚ãã¾ã§ã‚ªãƒã‚±ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¯ãã®ä½ç½®ã¾ãŸã¯ãƒ‡ãƒ¼ã‚¿å€¤ã ã‘ã§ä½•ã®å€¤ã§ã‚ã‚‹ã®ã‹åˆ¤åˆ¥ã§ãã‚‹ãã‚‰ã„æ˜ç­ãªã¨ãã«ã®ã¿ä½¿ã†ã€‚å…ƒã€…ã¯schema.orgã®HowToStepã®ã¨ãã‚µã‚¤ãƒˆURLã€ç”»åƒURLã€å‹•ç”»URLã‚’ã‚ªãƒ—ã‚·ãƒ§ãƒ³å€¤ã¨ã—ã¦å—ã‘ä»˜ã‘ã‚‹æƒ³å®šã ã£ãŸã€‚ã“ã‚Œã‚‰ã¯ãƒ•ã‚¡ã‚¤ãƒ«æ‹¡å¼µå­ãŒç•°ãªã‚‹ãŸã‚ã€ã‚­ãƒ¼ãŒãªãã¦ã‚‚åˆ¤åˆ¥ã§ãã‚‹ã€‚ã¾ãŸã€ãã‚Œã‚‰ã®å€¤ã‚’å¼•ãå‡ºã—ã¦ã©ã†ä½¿ã†ã‹ã¯ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ã«å§”ã­ã‚‹æƒ³å®šã ã£ãŸã€‚ã‚ˆã£ã¦ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–ã¯ã—ãªã„ã€‚

ã€€ãµãŸã¤ç›®ã¯ãƒ†ã‚­ã‚¹ãƒˆã‚’çŸ­ãæ›¸ããŸã„ã‹ã‚‰ã€‚ã‚‚ã—ã‚­ãƒ¼ã‚’æ›¸ã„ã¦ã—ã¾ãˆã°æ—¢å­˜ã®XML,JSON,YAML,TOML,LTSVã®ã‚ˆã†ã«å†—é•·ãªãƒ†ã‚­ã‚¹ãƒˆã«ãªã£ã¦ã—ã¾ã†ã€‚ãã‚Œã«ã‚­ãƒ¼ã¯IDãªã®ã§ã€çµå±€ã¯ä¸€æ–‡å­—ã§ã‚‚é•ãˆã°æ©Ÿèƒ½ã—ãªã„ã€‚ãã‚Œãªã‚‰ä½ç½®ã‚’ã‚­ãƒ¼ã«ã—ãŸã£ã¦ã„ã„ã˜ã‚ƒãªã„ã‹ã€ã¨ã„ã†ç™ºæƒ³ã€‚äººãŒæ‰‹ã§å…¥åŠ›ã™ã‚‹ã¨ãƒŸã‚¹ãŒç™ºç”Ÿã—ã†ã‚‹ãŸã‚ã€ãã®æ„å‘³ã§ã‚‚ã§ãã‚‹ã ã‘å…¥åŠ›å€¤ã®é‡ã¯æ¸›ã‚‰ã—ãŸã„ã€‚çŸ­ãæ›¸ããŸã„ã€‚ãã®ãŸã‚ã«ã¯ã‚­ãƒ¼ã‚’æ¸›ã‚‰ã™ã—ã‹ãªã„ã€‚ã‚­ãƒ¼ãŒãªã‘ã‚Œã°ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–ã§ããªã„ã€‚ã‚ˆã£ã¦æœ¬ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆåŒ–ã¯éå¯¾å¿œã§ã‚ã‚‹ã€‚

ã€€ãƒ‘ãƒ³ããšãƒªã‚¹ãƒˆã®shcema.orgã‚’ã‚ã‚‰ã‚ã™BreadcrumbListã«ã¤ã„ã¦ã€‚ãƒ†ã‚­ã‚¹ãƒˆã§æ›¸ãã€ãã‚Œã‚’ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«å¤‰æ›ã™ã‚‹ã€‚

bread-crumb-list.txt
```
ğŸ   https://example.com/
å¤§ã‚«ãƒ†ã‚´ãƒª    https://example.com/category1/
ä¸­ã‚«ãƒ†ã‚´ãƒª    https://example.com/category1/category2
å°ã‚«ãƒ†ã‚´ãƒª    https://example.com/category1/category2/category3
```
å‚ç…§æ–¹æ³•ã®ç¢ºèª
```javascript
const txt = await fetch('bread-crumb-list.txt')
const elements = TextElement.Single(txt)
elements[0].name;         // ğŸ 
elements[0].options[0];   // https://example.com/
elements[1].name;         // å¤§ã‚«ãƒ†ã‚´ãƒª
elements[1].options[0];   // https://example.com/category1/
elements[2].name;         // ä¸­ã‚«ãƒ†ã‚´ãƒª
elements[2].options[0];   // https://example.com/category1/category2
elements[3].name;         // å°ã‚«ãƒ†ã‚´ãƒª
elements[3].options[0];   // https://example.com/category1/category2/category3
```
main.js
```javascript
window.addEventListener('load', async(event)=>{
    function generateBreadcrumbList() {
        const elements = TextElement.Single(txt)
        const bread = {'@context': 'https://schema.org', '@type': 'BreadcrumbList'}
        bread.itemListElement = [] 
        for (let i=0; i<elements.length; i++) {
            const item = {'@context': 'https://schema.org', '@type': 'ListItem'}
            item.position = i
            item.name = elements[i].name
            item.item = elements[i].options[0]
            bread.itemListElement.push(item)
        }
        return bread
    }
    const jsonLdStr = JSON.stringify(
                        generateBreadcrumbList(
                            await fetch('bread-crumb-list.txt')))
});
```

```javascript
class TextElement {
    Single(line, indent='    ') {
        const obj = {}
        const values = line.split(indent)
        obj.name = values[0]
        if (1 < values.length) { obj.options = values.slice(1); }
        return obj
    }
}
```

### MultiLineElementï¼ˆè¤‡æ•°è¡Œè¦ç´ ï¼‰

ã€€MultiLineElementï¼ˆè¤‡æ•°è¡Œè¦ç´ ï¼‰ã¯ã€è¤‡æ•°ã®SingleLineElementï¼ˆå˜ä¸€è¡Œè¦ç´ ï¼‰ã§ã²ã¨ã¤ã®è¦ç´ ã‚’ã‚ã‚‰ã‚ã™ã€‚ã•ã‚‰ã«è¦ç´ ã‚’ã²ã¨ã¤ã®ãƒ†ã‚­ã‚¹ãƒˆå†…ã§è¤‡æ•°æ›¸ã‘ã‚‹ã€‚ãã®ã¨ãã¯2è¡Œã®æ”¹è¡Œã§é–“ã‚’ã‚ã‘ã‚‹ã€‚

```
ã²ã¨ã¤ç›®ã®è¦ç´ ã«ãŠã‘ã‚‹1è¡Œç›®ã®è¦ç´ 
ã²ã¨ã¤ç›®ã®è¦ç´ ã«ãŠã‘ã‚‹2è¡Œç›®ã®è¦ç´ 

ãµãŸã¤ç›®ã®è¦ç´ ã«ãŠã‘ã‚‹1è¡Œç›®ã®è¦ç´ 
ãµãŸã¤ç›®ã®è¦ç´ ã«ãŠã‘ã‚‹2è¡Œç›®ã®è¦ç´ 
```

```javascript
const items = []
let begin = 0
let end = 0
const lines = txt.split('\n')
for (let i=0; i<lines.length; i++) {
    end++;
    if (lines[i]) { begin = end + 1; }
    else {
        items.push(TextElement.Single(lines.slice(begin, end).join('\n')))
    }
}
return items
```

ã€€ã‘ã‚Œã©2è¡Œæ”¹è¡ŒãŒã¤ãã®å ´åˆã ã¨æ­£ã—ãå‹•ä½œã—ãªã„ã€‚

* 2è¡Œæ”¹è¡Œã§ãªã3è¡Œã€4è¡Œãªã©ã‚‚ã£ã¨å¤šã„æ”¹è¡Œã§ã‚ã‚‹
* æœ«å°¾ã«æ”¹è¡ŒãŒãªã„
* æœ«å°¾ã«2è¡Œæ”¹è¡Œã‚ˆã‚Šå¤šã„æ”¹è¡ŒãŒã‚ã‚‹

```javascript
class TextElement {
    Multi(txt, indent='    ') {
        const items = []
        let begin = 0
        let end = 0
        let brank = 0
        const lines = txt.split('\n')
        for (let i=0; i<lines.length; i++) {
            end++;
            if (!lines[i]) { // ç©ºè¡Œãªã‚‰
                // SingleLineElementï¼ˆå˜ä¸€è¡Œè¦ç´ ï¼‰ã‚’è¿½åŠ ã™ã‚‹
                items.push(lines.slice(begin, end).map(line=>TextElement.Single(line, indent)))
                /*
                const item = []
                for (const line of lines.slice(begin, end)) {
                    item.push(TextElement.Single(line, indent))
                }
                items.push(item)
                */
                //items.push(TextElement.Single(lines.slice(begin, end).join('\n'), indent))
                // æ¬¡ã®è¦ç´ ã¾ã§ã«ã‚ã‚‹ç©ºè¡Œã‚’ã™ã¹ã¦é£›ã°ã™
                begin = end + 1
                for(let n=begin; n<lines.length; n++) {
                    if (lines[n]) { begin++; }
                }
                end = begin
                i = begin
            }
        }
        return items
    }
}
```

ã€€schema.orgã®FAQã‚’ä¾‹ã«ã—ã¦ã¿ã‚‹ã€‚

faq.txt
```
ã‚ˆãã‚ã‚‹è³ªå•ã¯å¿…è¦ã§ã™ã‹ï¼Ÿ
ã¯ã„ã€å¿…è¦ã§ã™ã€‚

è¤‡æ•°ã®è³ªå•ã‚’æ›¸ããŸã„ã§ã™ã‚ˆã­ï¼Ÿ
ã¯ã„ã€æ›¸ããŸã„ã§ã™ã€‚
```

main.js
```javascript
window.addEventListener('load', async(event)=>{
    function generateFaq(txt) {
        const elements = TextElement.Multi(txt)
        const faq = {'@context': 'https://schema.org', '@type': 'FAQPage'}
        faq.mainEntity = [] 
        for (const element of elements) {
            const item = {'@context': 'https://schema.org', '@type': 'Question'}
            item.name = element[0].name
            item.acceptedAnswer = {
                '@type': 'Answer',
                text: element[1].name,
            }
            faq.mainEntity.push(item)
        }
        return faq
    }
    const jsonLdStr = JSON.stringify(
                        generateFaq(
                            await fetch('faq.txt')))
});
```

ã€€ãªãŠã€ã“ã®ãƒ†ã‚­ã‚¹ãƒˆå½¢å¼ã«ãŠã„ã¦ã‚³ãƒ¡ãƒ³ãƒˆã¯å®Ÿè£…ã—ãªã„ã€‚ã‚ˆãã‚ã‚‹ã®ã¯è¡Œé ­`#`ã‚„`;`ã®ã¨ãã«ã‚³ãƒ¡ãƒ³ãƒˆã¨ã„ã†æ›¸å¼ã§ã‚ã‚‹ã€‚ãã‚Œã‚‰ã¯å®Ÿè£…ã—ãªã„ã€‚ã§ãã‚‹ã ã‘ã‚·ãƒ³ãƒ—ãƒ«ã«ã—ãŸã„ã‹ã‚‰ã€‚ãã‚‚ãã‚‚ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰è¤‡é›‘ãªschema.orgã‚’ä½œã‚ŠãŸã„ã¨ã„ã†è¦ä»¶ã ã£ãŸã®ã§ã€ã‚½ãƒ¼ã‚¹ã®ãƒ†ã‚­ã‚¹ãƒˆãŒè¤‡é›‘ã«ãªã£ã¦ã—ã¾ã£ãŸã‚‰æœ¬æœ«è»¢å€’ã€‚ä½™è¨ˆãªæ©Ÿèƒ½ã‚‚ä½œã‚Šè¾¼ã¿ãŸããªã„ã€‚

### TreeElementï¼ˆæœ¨æ§‹é€ è¦ç´ ï¼‰

ã€€TreeElementï¼ˆæœ¨æ§‹é€ è¦ç´ ï¼‰ã¯ãƒ„ãƒªãƒ¼æ§‹é€ ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚ã‚‰ã‚ã™ã€‚ãƒ„ãƒªãƒ¼ã¯è¦ªå­é–¢ä¿‚ã‚’ã‚‚ã£ãŸãƒãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆã§ã‚ã‚‹ã€‚ã²ã¨ã¤ã®ãƒãƒ¼ãƒ‰ã¯SingleLineElementã§ã‚ã‚‰ã‚ã™ã€‚

```javascript
const root = TextElement.Tree(txt)
root.indent  // å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆï¼ˆ'\t','  ','    ',ï¼‰
root.maxDeps // rootã ã‘ãŒã‚‚ã¤ã€‚æœ€æ·±éšå±¤æ•°
root.deps    // ç¾åœ¨ã®éšå±¤æ•°
root.nodes   // å­ã®é…åˆ—
root.name    // åå‰ã€‚å€¤ã€‚å¿…é ˆå€¤
root.options // ã‚ªãƒ—ã‚·ãƒ§ãƒ³å€¤
```

ã€€schema.orgã®`HowTo`ãŒã‚‚ã¤`step`å€¤ã‚’ä»¥ä¸‹ãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ç”Ÿæˆã—ãŸã„ã€‚ã“ã®ã¨ãã€ã¾ãšãƒ†ã‚­ã‚¹ãƒˆã‹ã‚‰ãƒ„ãƒªãƒ¼æ§‹é€ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆã™ã‚‹ã®ãŒä»Šå›ã®å¯¾è±¡ç¯„å›²ã§ã‚ã‚‹ã€‚

```
ã‚»ã‚¯ã‚·ãƒ§ãƒ³1
    æ‰‹é †1-1
        æ‰‹é †1-1-1
        TIP:ãƒ’ãƒ³ãƒˆ1
    æ‰‹é †1-2
        æ‰‹é †1-2-1
        TIP:ãƒ’ãƒ³ãƒˆ2
ã‚»ã‚¯ã‚·ãƒ§ãƒ³2
    æ‰‹é †2-1
        æ‰‹é †2-1-1
        TIP:ãƒ’ãƒ³ãƒˆ3
    æ‰‹é †2-2
        æ‰‹é †2-2-1
        TIP:ãƒ’ãƒ³ãƒˆ4
```

ã€€ãƒ„ãƒªãƒ¼ãƒ†ã‚­ã‚¹ãƒˆã‚’1è¡Œãšã¤ã¿ã‚‹ã¨ãã€ä»¥ä¸‹ã®ã‚ˆã†ã«éšå±¤å·®ã§ã ã‚Œã®å­ã¨ã—ã¦æŒ¿å…¥ã™ã‚‹ã‹åˆ¤æ–­ã™ã‚‹ã€‚

éšå±¤å·®|é–¢ä¿‚
------|----
å‰è¡Œã¨åŒã˜|parent.childrenã®æœ«å¼Ÿã€‚
å‰è¡Œã‚ˆã‚Š1æ·±ã„|now.childrenã®é•·å…„ã€‚
å‰è¡Œã‚ˆã‚Š1æµ…ã„|parent.childrenã®æœ«å¼Ÿã€‚
ãã‚Œä»¥å¤–|ä¸æ­£å€¤

```javascript
class TextElement {
    Tree(txt) {
        const root = {}
        const LINES = txt.split('\n')
        root.indentText = this.#guessIndent(LINES)
        root.maxDepth = 1
        let [depth, preDepth] = [1, 1]
        const parents = [root]
        for (const line of LINES) {
            if (!line) { break; }
            depth = getDepth(line)
            this.#validDepth(depth, preDepth)
            const node = this.Single(line.slice(root.indent.length * depth), root.indent)
            let parent = parents[parents.length-1]
            if (preDepth === depth) { parent.nodes.push(node); }
            else if (preDepth < depth) { parents.push(node); parent.nodes[parent.nodes.length-1].push(node); }
            //else if (preDepth < depth) { parents.push(node); parent.nodes[parent.nodes.length-1].nodes.push(node); }
            else if (depth < preDepth) { parents.pop(); parent.nodes.push(node); }
            else if (preDepth < depth) { parent.nodes.push(node); }
            if (root.maxDepth < parents.lenght) { root.maxDepth = parents.lenght; }
            root.nodes.push(node)
        }
        return root
    }
    #getParent(root, depth) {
        let target = root
        for (let i=1; i<depth; i++) {
            if (!target.hasOwnProperty('nodes')) { target.nodes = []; }
            target = target.nodes
        }
        return target
    }
    #addChild(parent, child) {
        if (!parent.hasOwnProperty('nodes')) { parent.nodes = []; }
        parent.nodes.push(child)
    }
    #validDepth(depth, preDepth) {
        if (0 < depth && (depth === preDepth || depth === preDepth + 1 || depth === preDepth - 1)) { return true; }
        throw TextElementIndentDepthError(`ãƒ†ã‚­ã‚¹ãƒˆã®éšå±¤ãŒä¸æ­£ã§ã™ã€‚å‰ã®è¡Œã¨åŒã˜ã‹ã²ã¨ã¤ã ã‘æ·±ã„ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆã®ã¿è¨±å¯ã•ã‚Œã¾ã™ã€‚`)
    }
    #getDepth(line, indent) {
        let depth = 1;
        while (line.startsWith(indent.repeat(depth))) { depth++ }
        return depth
    }
    #guessIndentText(LINES) { // ãƒ†ã‚­ã‚¹ãƒˆå†…ã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ–‡å­—ã‚’æ¨æ¸¬ã™ã‚‹ï¼ˆæœ€åˆã«è¦‹ã¤ã‹ã£ãŸæ‰€å®šã®ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ–‡å­—ãŒãã‚Œã¨ã™ã‚‹ã€‚ä»¥é™ãã‚Œã‚’ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ–‡å­—ã¨ã—ã¦ä½¿ã‚ã‚Œã‚‹ã“ã¨ã‚’æœŸå¾…ã™ã‚‹ï¼‰
        const INDENTS = ['\t'].concat([2,4,8].map((i)=>' '.repeat(i)))
        for (const line of LINES) {
            return INDENTS.find(indent=>line.startsWith(indent))
        }
    }
}
```

main.js
```javascript
window.addEventListener('load', async(event)=>{
    function generateHowTo(txt) {
        const howto = {'@context': 'https://schema.org', '@type': 'HowTo'}
        howto.step = []
        const root = TextElement.Tree(txt)
        if (3 === root.maxDepth) { // 3å±¤
            for (const node of root.nodes) {
                const section = this.#Section(node)
                if (node.nodes) {
                    for (const step of node.nodes) {
                        section.itemElementList.push(this.#Step(step))
                    }
                }
                howto.step.push(section)
            }
        } else { // 1,2å±¤
            for (const step of root.nodes) {
                howto.step.push(this.#Step(step))
            }
        }
        return howto
    }
    #Section(node) {
        const section = {'@context': 'https://schema.org', '@type': 'HowToSection'}
        section.name = node.name
        section.itemElementList = []
    }
    #Step(node) {
        const step = {'@context': 'https://schema.org', '@type': 'HowToStep'}
        if (node.nodes) {
            for (const child of node.nodes) {
                step.itemElementList = []
                if (child.name.toUpperCase().startsWith('TIP:')) { step.itemElementList.push(this.#Direction(node)); }
                else { step.itemElementList.push(this.#Tip(node)); }
            }
        } else { step.text = node.name; }
    }
    #Direction(node) { return {'@context': 'https://schema.org', '@type': 'HowToDirection', text:node.name }; }
    #Tip(node) { return {'@context': 'https://schema.org', '@type': 'HowToTip', text:node.name }; }
    const jsonLdStr = JSON.stringify(
                        generateFaq(
                            await fetch('how-to-steps.txt')))
});
```

### CompositeElementï¼ˆè¤‡åˆå½¢ï¼‰

ã€€CompositeElementï¼ˆè¤‡åˆå½¢ï¼‰ã¯ä»¥ä¸‹ã®è¤‡åˆå½¢ã§ã‚ã‚‹ã€‚

* SingleLineElementï¼ˆä¸€è¡Œã§å€¤ã¨ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’ã‚ã‚‰ã‚ã™ã€‚ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ–‡å­—ã§å€¤ã‚„ã‚ªãƒ—ã‚·ãƒ§ãƒ³é–“ã‚’åŒºåˆ‡ã‚‹ï¼‰
* MultiLineElementï¼ˆè¤‡æ•°ã®SingleLineElementã§ã²ã¨ã¤ã®è¦ç´ ã‚’ã‚ã‚‰ã‚ã™ã€‚2ç©ºè¡Œã§è¦ç´ é–“ã‚’åŒºåˆ‡ã‚‹ï¼‰
* TreeElementï¼ˆã²ã¨ã¤ã®æœ¨æ§‹é€ ã‚’ã‚ã‚‰ã‚ã™ï¼‰

ã€€schema.orgã®HowToå…¨ä½“ã‚’ã‚ã‚‰ã‚ã™ãŸã‚ã«å®Ÿè£…ã™ã‚‹ã€‚

how-to-1.txt
```
MultiLineElementï¼ˆHowToã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€‚åå‰ã€æ‰€è¦æ™‚é–“ã€ç”»åƒã€ãƒ“ãƒ‡ã‚ªãªã©ï¼‰

MultiLineElementï¼ˆHowToSupplyé…åˆ—ï¼‰

MultiLineElementï¼ˆHowToToolé…åˆ—ï¼‰

TreeElementï¼ˆHowToSection, HowToStep, HowToDirection, HowToTipï¼‰
```

how-to-1.txt
```
MultiLineElementï¼ˆHowToã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€‚åå‰ã€æ‰€è¦æ™‚é–“ã€ç”»åƒã€ãƒ“ãƒ‡ã‚ªãªã©ï¼‰
name
image
video
estimatedCost
totalTime

MultiLineElementï¼ˆHowToSupplyé…åˆ—ï¼‰
name    image   
MultiLineElementï¼ˆHowToToolé…åˆ—ï¼‰

TreeElementï¼ˆHowToSection, HowToStep, HowToDirection, HowToTipï¼‰
ã‚»ã‚¯ã‚·ãƒ§ãƒ³1
    æ‰‹é †1-1     url     image   video
        æ‰‹é †1-1-1
        TIP:ãƒ’ãƒ³ãƒˆ1
    æ‰‹é †1-2     url     image   video
        æ‰‹é †1-2-1
        TIP:ãƒ’ãƒ³ãƒˆ2
ã‚»ã‚¯ã‚·ãƒ§ãƒ³2
    æ‰‹é †2-1     url     image   video
        æ‰‹é †2-1-1
        TIP:ãƒ’ãƒ³ãƒˆ3
    æ‰‹é †2-2     url     image   video
        æ‰‹é †2-2-1
        TIP:ãƒ’ãƒ³ãƒˆ4
```

ã€€ã“ã®ã¨ãè¨±å¯ã•ã‚Œã‚‹ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ä»¥ä¸‹ã€‚

* Multi, Multi, Multi, Tree
* Multi, Multi, Treeï¼ˆ2ã¤ç›®ã®Multiã¯Toolã§ãªãSupplyï¼ˆé“å…·ã¯ä¸è¦ã§ã‚‚ç´ æã¯å¿…è¦ã«ãªã‚‹ã®ãŒä¸€èˆ¬çš„ãªæ‰‹é †ã ã‹ã‚‰ï¼‰ï¼‰
* Multi, Tree

ã€€è¤‡åˆç³»ã®ã¨ãã€å„å‹ã¨ã®åŒºåˆ¥ã¯2ã¤ä»¥ä¸Šã®ç©ºè¡Œã§è¡Œã†ã€‚

```javascript
TextElement.Composite(txt, '    ', 'MmmT')
```

å¼•æ•°|èª¬æ˜
----|----
1|å…¥åŠ›ãƒ†ã‚­ã‚¹ãƒˆ
2|ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ–‡å­—åˆ—
3|è¤‡åˆå‹ã®ä½ç½®ã¨ãã®å†…å®¹å‹

ã€€ç¬¬ä¸‰å¼•æ•°ã«ã¤ã„ã¦ã€‚å„å­—ã¯å‹ã‚’ã‚ã‚‰ã‚ã™ã€‚é †åºã¯ãã®å‹ãŒã‚ã‚‰ã‚ã‚Œã‚‹ä½ç½®ã‚’ã‚ã‚‰ã‚ã™ã€‚å°æ–‡å­—ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚ã‚Šå¤§æ–‡å­—ã¯å¿…é ˆã§ã‚ã‚‹ã€‚ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãªã‚‰å­˜åœ¨ã—ãªãã¦ã‚‚ã‚ˆã„ã€‚

å€¤|èª¬æ˜
--|----
`s`,`S`|`SimpleElement`å‹ï¼ˆä»»æ„,å¿…é ˆï¼‰
`m`,`M`|`MultiLineElement`å‹ï¼ˆä»»æ„,å¿…é ˆï¼‰
`t`,`T`|`TreeElement`å‹ï¼ˆä»»æ„,å¿…é ˆï¼‰

ã€€å„å‹ã¯2è¡Œä»¥ä¸Šã®ç©ºè¡Œã§åŒºåˆ‡ã‚‰ã‚Œã‚‹ã€‚ã‚ˆã£ã¦`MmmT`ã®ã‚ˆã†ã«4å­—ã‚ã‚Œã°æœ€å¤§3ã¤ã®2è¡Œä»¥ä¸Šç©ºè¡ŒãŒã‚ã‚‹ã€‚ãŸã ã—å°æ–‡å­—ã®`mm`ã¯ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚ã‚Šã€å­˜åœ¨ã—ãªã„å ´åˆãŒã‚ã‚Šã†ã‚‹ã€‚ã¤ã¾ã‚Š2è¡Œä»¥ä¸Šç©ºç™½ã¯ã€3,2,1ã¤ã®3ãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚Šã†ã‚‹ã€‚

ã€€ã‚‚ã—ç¬¬ä¸‰å¼•æ•°ãŒ`null`,`ç©ºæ–‡å­—`,`undefined`ã§ã‚ã‚Œã°è‡ªå‹•æ¨æ¸¬ã™ã‚‹ã€‚ã¾ãšã¯2è¡Œä»¥ä¸Šç©ºè¡Œã‚’ã•ãŒã™ã€‚ãã‚Œã‚‰ã‚’ãƒ†ã‚­ã‚¹ãƒˆå¡Šã¨ã—ã€ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ–‡å­—ãŒå…ˆé ­ã«å«ã¾ã‚Œã¦ã„ã‚‹è¡ŒãŒã‚ã‚Œã°Treeå‹ã¨åˆ¤æ–­ã™ã‚‹ã€‚ãã‚Œä»¥å¤–ã§ã‚ã‚Œã°Multiå‹ã¨åˆ¤æ–­ã™ã‚‹ã€‚

ã€€ã‚‚ã—ç¬¬ä¸‰å¼•æ•°ãŒ`null`,`ç©ºæ–‡å­—`,`undefined`ã§ãªãã€`s`,`S`,`m`,`M`,`t`,`T`ä»¥å¤–ã®æ–‡å­—ãŒå«ã¾ã‚Œã¦ã„ãŸã‚‰ã€ä¸æ­£å€¤ã¨ã—ã¦ä¾‹å¤–ã‚’ç™ºç”Ÿã•ã›ã‚‹ã€‚

```javascript
class TreeElement {
    Composite(txt, indent='    ', format='') {

    }
}
```
```javascript
class TreeElement {
    #Composite(txt, indent='    ', format='') { // 2è¡Œä»¥ä¸Šç©ºè¡Œã®ç®‡æ‰€ã§åˆ†æ–­ã™ã‚‹ã€‚
        const items = this.#CompositeItems(txt.split('\n'), indent)
        // formatã«ã‚ˆã‚‹ãƒãƒªãƒ‡ãƒ¼ãƒˆ
        if (format) {}
        return items
    }
    #validCompositeFormatString(format) {
        const VALIDS = ['s','m','t','S','M','T']
        for (let i=0; i<format.length; i++) {
            if (!VALIDS.some(format.charAt(i)) { throw new TextElementError(`Compositeã®formatãŒä¸æ­£å€¤ã§ã™ã€‚æ¬¡ã®ã„ãšã‚Œã‹ã®æ–‡å­—ã ã‘ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚\n${VALIDS.join('\n')}\nã‚ã‚‹ã„ã¯æœªè¨­å®šã€ç©ºæ–‡å­—ã€null, undefinedã«ã™ã‚‹ã¨è‡ªå‹•æ¨æ¸¬ã—ã¾ã™ã€‚2è¡Œä»¥ä¸Šç©ºç™½ã§è¦ç´ ã‚’åŒºåˆ‡ã‚Šã€ãã®è¦ç´ å‹ã¯MultiLineElementã‹TreeElementã®ã„ãšã‚Œã‹ã§ã‚ã‚‹ã¨åˆ¤æ–­ã—ã¾ã™ã€‚è¦ç´ å†…ã®å…¨è¡Œã®ã†ã¡ã²ã¨ã¤ã§ã‚‚è¡Œé ­ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆå€¤ã‚’ã‚‚ã¤è¡ŒãŒã‚ã‚Œã°Treeã¨åˆ¤æ–­ã—ã¾ã™ã€‚`); }
        }
    }
    #validCompositeFormat(items, format) {
        for (let i=0; i<items.length; i++) {
            
            if (['S','M','T'].some(items[i].type))
            if (['s','m','t'].some)
        }
    }
    #CompositeItems(LINES, indent='    ') { // 2è¡Œä»¥ä¸Šç©ºè¡Œã®ç®‡æ‰€ã§åˆ†æ–­ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã®é…åˆ—ã‚’è¿”ã™ã€‚
        const items = []
        const txts = this.#CompositeTxts(LINES)
        for (const txt of txts) {
            const item = {}
            let method = this.MultiLineElement
            for (const line of txt) {
                if (line.startsWith(indent)) { method = this.TreeElement }
            }
            item.type = (line.startsWith(indent)) ? 'T' : 'M'
            method = (line.startsWith(indent)) ? this.Tree : this.Multi
            item.txt = method(txt, indent)
            items.push(item)
            //items.push(method(txt, indent))
        }
        return items
    }
    #CompositeTxts(LINES) { // 2è¡Œä»¥ä¸Šç©ºè¡Œã®ç®‡æ‰€ã§åˆ†æ–­ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã®é…åˆ—ã‚’è¿”ã™ã€‚
        const ranges = #CompositeTxtRanges(LINES)
        return ranges.map(r=>LINES.slice(r.begin, r.end))
        const txts = []
        for (const range of ranges) {
            txts.push(txt.slice(range.begin, range.end))
        }
        return txts
    }
    #CompositeTxtRanges(LINES) { // 2è¡Œä»¥ä¸Šç©ºè¡Œã®ç®‡æ‰€ã§åˆ†æ–­ã™ã‚‹ã€‚
        const ranges = []
        let [begin, end, blank] = [0, 0, 0]
        for (let i=0; i<LINES.length; i++) {
            end++;
            if (line) { continue; }
            ranges.push({begin:begin, end:end})
            // æ¬¡ã®è¦ç´ ã¾ã§ã«ã‚ã‚‹ç©ºè¡Œã‚’ã™ã¹ã¦é£›ã°ã™
            begin = end + 1
            for(let n=begin; n<lines.length; n++) {
                if (lines[n]) { begin++; }
            }
            end = begin
            i = begin
        }
        return ranges
    }
}
```

ã€€`format`ã«ã‚ˆã‚‹å‹ãƒã‚§ãƒƒã‚¯ã¯ã„ã‚‰ãªã„ã‹ã‚‚ã—ã‚Œãªã„ã€‚ã‚ˆãè€ƒãˆãŸã‚‰åˆ¥ã«MultiLineã¨Treeã®å‹ãƒã‚§ãƒƒã‚¯ã‚’ã™ã‚‹å¿…è¦ãªã‚“ã¦ãªã„ã€‚ãµã¤ã†ã«ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆãŒã‚ã‚Œã°Treeã«ã—ã¦ã€ãã‚Œä»¥å¤–ãªã‚‰Multiã§ã„ã„ã€‚ä»®ã«Treeæƒ³å®šã ã£ãŸä½ç½®ãŒMultiã ã£ãŸã¨ã—ã¦ã‚‚ã€ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãŒå¥½ãã«ã™ã‚Œã°ã„ã„ã€‚ã©ã®ã¿ã¡è¿”ã™ãƒ‡ãƒ¼ã‚¿ã¯é…åˆ—ã‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ãªã‚‹ãŸã‚ã€ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶å´ã§åˆ¶å¾¡ã›ã­ã°ãªã‚‰ãªã„ã®ã ã‹ã‚‰ã€‚

```javascript
class TreeElement {
    #Composite(txt, indent='    ') { // 2è¡Œä»¥ä¸Šç©ºè¡Œã®ç®‡æ‰€ã§åˆ†æ–­ã™ã‚‹ã€‚
        const items = this.#CompositeItems(txt.split('\n'), indent)
    }
    #CompositeItems(LINES, indent='    ') { // 2è¡Œä»¥ä¸Šç©ºè¡Œã®ç®‡æ‰€ã§åˆ†æ–­ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã®é…åˆ—ã‚’è¿”ã™ã€‚
        const items = []
        const txts = this.#CompositeTxts(LINES)
        for (const txt of txts) {
            let method = this.Multi
            for (const line of txt) {
                if (line.startsWith(indent)) { method = this.Tree }
            }
            items.push(method(txt, indent))
        }
        return items
    }
    #CompositeTxts(LINES) { // 2è¡Œä»¥ä¸Šç©ºè¡Œã®ç®‡æ‰€ã§åˆ†æ–­ã•ã‚ŒãŸãƒ†ã‚­ã‚¹ãƒˆã®é…åˆ—ã‚’è¿”ã™ã€‚
        const ranges = #CompositeTxtRanges(LINES)
        return ranges.map(r=>LINES.slice(r.begin, r.end))
        const txts = []
        for (const range of ranges) {
            txts.push(txt.slice(range.begin, range.end))
        }
        return txts
    }
    #CompositeTxtRanges(LINES) { // 2è¡Œä»¥ä¸Šç©ºè¡Œã®ç®‡æ‰€ã§åˆ†æ–­ã™ã‚‹ã€‚
        const ranges = []
        let [begin, end, blank] = [0, 0, 0]
        for (let i=0; i<LINES.length; i++) {
            end++;
            if (line) { continue; }
            ranges.push({begin:begin, end:end})
            // æ¬¡ã®è¦ç´ ã¾ã§ã«ã‚ã‚‹ç©ºè¡Œã‚’ã™ã¹ã¦é£›ã°ã™
            begin = end + 1
            for(let n=begin; n<lines.length; n++) {
                if (lines[n]) { begin++; }
            }
            end = begin
            i = begin
        }
        return ranges
    }
}
```

### HowToStepç³»

ã€€[Google schema.org HowTo][]ã®ã†ã¡`HowTo`é…ä¸‹ã®`HowToSection`, `HowToStep`, `HowToDirection`, `HowToTip`ã‚’ç”Ÿæˆã™ã‚‹ã€‚

[Google schema.org HowTo]:https://developers.google.com/search/docs/advanced/structured-data/how-to?hl=ja

#### HowTo

éšå±¤|ãƒ‘ã‚¿ãƒ¼ãƒ³
----|-------
1,2|Stepã®é…åˆ—ã‚’å«ã‚ã‚‹
1,2,3|Sectionã®é…åˆ—ã‚’å«ã‚ã‚‹

```javascript
{
    "@type": "HowTo",
    "step": [{"@type": "HowToStep"}, ...]
}
```
```javascript
{
    "@type": "HowTo",
    "step": [{
        "@type": "HowToSection",
        "name": "ã‚»ã‚¯ã‚·ãƒ§ãƒ³å",
        "itemListElement": [{
            "@type": "HowToStep"
            ...
        },{}]
    }, ...]
}
```

#### HowToStep

éšå±¤|ãƒ‘ã‚¿ãƒ¼ãƒ³
----|-------
1|Stepã«ç›´æ¥`text`ã‚’ã‚»ãƒƒãƒˆã™ã‚‹
2|Stepã®`itemListElement`ã«è¤‡æ•°ã®`Direction`ã‹`Tip`ã‚’å«ã‚ã‚‹

```javascript
{
    "@type": "HowToStep",
    "text": "æ‰‹é †",
}
```

```javascript
{
    "@type": "HowToStep",
    "name": "è¦ç´„"
    "itemListElement": [{
        "@type": "HowToDirect",
        "text": "æ‰‹é †",
    },{
        "@type": "HowToTip",
        "text": "ãƒ’ãƒ³ãƒˆ",
    }],
}
```

ã€€`Step`ã«ã¯ã•ã‚‰ã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã‚µã‚¤ãƒˆã®URLã€ç”»åƒã€å‹•ç”»ã‚’ã‚»ãƒƒãƒˆã§ãã‚‹ã€‚

```javascript
{
    "@type": "HowToStep",
    "text": "æ‰‹é †",
    "url": "è©²å½“ã™ã‚‹ã‚µã‚¤ãƒˆã®URL",
    "image": "è©²å½“ã™ã‚‹ç”»åƒURL",
    "video": "è©²å½“ã™ã‚‹å‹•ç”»URL",
}
```

```javascript
{
    "@type": "HowToStep",
    "name": "è¦ç´„"
    "url": "è©²å½“ã™ã‚‹ã‚µã‚¤ãƒˆã®URL",
    "image": "è©²å½“ã™ã‚‹ç”»åƒURL",
    "video": "è©²å½“ã™ã‚‹å‹•ç”»URL",
    "itemListElement": [{
        "@type": "HowToDirect",
        "text": "æ‰‹é †",
    },{
        "@type": "HowToTip",
        "text": "ãƒ’ãƒ³ãƒˆ",
    }],
}
```

ã€€`name`ã¯`itemListElement`ãŒã‚ã‚‹ã¨ãã€ãã®è¦ç´„ã¨ã—ã¦ã‚»ãƒƒãƒˆã™ã‚‹ã€‚`name`ã¯æ¨å¥¨ã§ã‚ã‚Šå¿…é ˆã§ã¯ãªã„ãŒã€äº‹å®Ÿä¸Šå¿…é ˆã§ã‚ã‚‹ã€‚

ã€€åé¢ã€`itemListElement`ãŒãªã`text`ã§è¡¨ç¾ã•ã‚Œã‚‹ã¨ãã€`name`ã‚’è¦ç´„ã¨ã—ã¦ã‚»ãƒƒãƒˆã™ã‚‹é »åº¦ã¯ã‚ã¾ã‚Šãªã„ã¨æ€ã‚ã‚Œã‚‹ã€‚ç†ç”±ã¯`text`ã¨ã—ã¦1æ–‡ã§ã—ã‹æ›¸ã‘ãªã„ã‹ã‚‰ã€ãã‚Œã‚’è¦ç´„ã™ã‚‹å¿…è¦æ€§ãŒè–„ã„ãŸã‚ã€‚ã•ã£ã•ã¨å…·ä½“çš„ã«`text`ã§æ›¸ã„ã¦ã—ã¾ã£ãŸã»ã†ãŒæ—©ã„ã€‚ã‚‚ã—ãŸãã•ã‚“ã®å·¥ç¨‹ãŒã‚ã‚‹ãªã‚‰`text`ã§ãªã`itemListElement`ã‚’ä½¿ã£ã¦è¡¨ç¾ã™ã¹ãã§ã‚ã‚‹ã€‚ã‚ˆã£ã¦ä»¥ä¸‹ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¯ãªã„ã€‚

```javascript
{
    "@type": "HowToStep",
    "name": "è¦ç´„",
    "text": "æ‰‹é †",
    "url": "è©²å½“ã™ã‚‹ã‚µã‚¤ãƒˆã®URL",
    "image": "è©²å½“ã™ã‚‹ç”»åƒURL",
    "video": "è©²å½“ã™ã‚‹å‹•ç”»URL",
}
```

ä½¿ç”¨|ãƒ‘ã‚¿ãƒ¼ãƒ³|ç†ç”±
----|--------|----
â­•|`text`|ã²ã¨ã¤ã®æ‰‹é †ã‚’ä¸€æ–‡ã§ã‚·ãƒ³ãƒ—ãƒ«ã«ã‚ã‚‰ã‚ã™
âŒ|`name`-`text`|ä¸€æ–‡ã§ã‚ã‚‰ã‚ã›ã‚‹ãªã‚‰ãã®è¦ç´„ã¯ä¸è¦
â­•|`name`-`itemListElement`|ã²ã¨ã¤ã®æ‰‹é †ã‚’ã•ã‚‰ã«è©³ç´°ãªå·¥ç¨‹ã«ã‚ã‘ã¦è¡¨ç¾ã™ã‚‹ã€‚ãã®è¦ç´„ã¨ã—ã¦`name`ãŒã»ã—ã„ã€‚

ãƒ‘ã‚¿ãƒ¼ãƒ³|ä¾‹
--------|--
`text`|`ACã‚¢ãƒ€ãƒ—ã‚¿ã‚’ã‚³ãƒ³ã‚»ãƒ³ãƒˆã«æŒ¿ã™ã€‚`
`name`-`text`|`ãƒ©ã‚ºãƒ‘ã‚¤ã®é›»æºã‚’å…¥ã‚Œã‚‹ã€‚`-`ACã‚¢ãƒ€ãƒ—ã‚¿ã‚’ã‚³ãƒ³ã‚»ãƒ³ãƒˆã«æŒ¿ã™ã€‚`
`name`-`itemListElement`|`ãƒ©ã‚ºãƒ‘ã‚¤ã®é›»æºã‚’å…¥ã‚Œã‚‹ã€‚`-[`ACã‚¢ãƒ€ãƒ—ã‚¿ã‚’ã‚³ãƒ³ã‚»ãƒ³ãƒˆã«æŒ¿ã™ã€‚`, `é›»æºã‚¹ã‚¤ãƒƒãƒã‚’å…¥ã‚Œã‚‹ã€‚`, `ãƒ–ãƒ¼ãƒˆãŒå®Œäº†ã¾ã§å¾…ã¤`, `TIP:HDDãªã‚‰60ç§’ã€SSDãªã‚‰30ç§’ãã‚‰ã„ã€‚`]

* `name`-`text`ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã¨ãã‚‚æ¬²ã—ã„ãŒã€ãã‚Œã¯`name`-`itemListElement`ãƒ‘ã‚¿ãƒ¼ãƒ³ã§ä»£ç”¨ã§ãã‚‹ã€‚ã‚ˆã£ã¦ä¸è¦ã€‚
* `HowToDirection`ã‹`HowToTip`ã‹ã®åˆ¤æ–­ã¯ãƒ†ã‚­ã‚¹ãƒˆã®å…ˆé ­ãŒ`TIP:`ã‹å¦ã‹ã§åˆ¤æ–­ã™ã‚‹ã“ã¨ã«ã™ã‚‹


* å˜ä¸€è¡Œã§ã²ã¤ã¤ã®è¦ç´ ã‚’ã‚ã‚‰ã‚ã™ï¼ˆåŒä¸€è¡Œã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ä»˜ä¸å¯ï¼‰
* è¤‡æ•°è¡Œã§ã²ã¨ã¤ã®è¦ç´ ã‚’ã‚ã‚‰ã‚ã™ï¼ˆ2ã¤ä»¥ä¸Šã®æ”¹è¡Œã§æ¬¡ã®æ–°ã—ã„åˆ¥ã®è¦ç´ ã¸ã€‚è¦ç´ ã¯è¡Œä½ç½®ã§å€¤ã‚’å–ã‚Šå‡ºã—ã€schema.orgã‚­ãƒ¼ã¨ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ï¼‰
* ãƒ„ãƒªãƒ¼æ§‹é€ ï¼ˆãƒã‚¹ãƒˆã§åŒ…å«é–¢ä¿‚ã‚’ã‚ã‚‰ã‚ã™ã€‚åŒä¸€è¡Œã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ä»˜ä¸å¯ï¼‰

ã€€æ‰‹é †ã®å·¥ç¨‹ã¯ãƒ„ãƒªãƒ¼æ§‹é€ ã«ãªã£ã¦ã„ã‚‹ã€‚ãªã®ã§ãã®éšå±¤ã‹ã‚‰










```javascript
{
    "@type": "HowToStep",
    "text": "æ‰‹é †",
    "step": [{"@type": "HowToStep"}, ...]
}
```



1å±¤
```
æ‰‹é †1   ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ç”»åƒURL
æ‰‹é †2   ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ç”»åƒURL
æ‰‹é †3   ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ç”»åƒURL
```

2å±¤
```
æ‰‹é †1   ã‚µã‚¤ãƒˆURL   ç”»åƒURL     å‹•ç”»URL
    æ‰‹é †1-1
    ãƒ’ãƒ³ãƒˆ
æ‰‹é †2
    æ‰‹é †2-1
    ãƒ’ãƒ³ãƒˆ
```

3å±¤
```
ã‚»ã‚¯ã‚·ãƒ§ãƒ³1
    æ‰‹é †1
        æ‰‹é †1-1
        ãƒ’ãƒ³ãƒˆ
    æ‰‹é †2
        æ‰‹é †2-1
        ãƒ’ãƒ³ãƒˆ
ã‚»ã‚¯ã‚·ãƒ§ãƒ³2
    æ‰‹é †1
        æ‰‹é †1-1
        ãƒ’ãƒ³ãƒˆ
```

